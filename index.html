<html>
  <head>
    <title>Nautilus</title>
    <script type="text/javascript">
      var lastReload = new Date();
      var lastAnim = new Date();
      var lastLoaded = new Date();

      function debugInfo() {
        var debug = document.getElementById("debug");
        debug.innerText = "Last reload: " + lastReload.toLocaleTimeString() +
          "\nLast frame: " + lastAnim.toLocaleTimeString() +
          "\nLast render: " + lastLoaded.toLocaleTimeString();
      }

      var doPrev = 0;

      function anim() {
        lastAnim = new Date();
        var cb = lastAnim.getTime();

        document.getElementById("frame").src = 'https://s3-us-west-1.amazonaws.com/simplecast/nautilus.jpg?v=' +
          cb;

        doPrev++;

        if (doPrev == 5) {
          document.getElementById("prev").src = 'https://s3-us-west-1.amazonaws.com/simplecast/previous.jpg?v=' +
            cb;
          doPrev = 0;
        }

        debugInfo();

        if (lastAnim.getTime() - lastLoaded.getTime() > 20000) {
          location.reload();
        } else {
          setTimeout(anim, 1000);
        }
      }

      function imgLoaded() {
        lastLoaded = new Date();
        debugInfo();
      }
    </script>
  </head>
  <body style="text-align: center; background-color: #222; margin: 0">
    <div id="debug" style="position: absolute; color: white; text-align: left; font-family: monospace">
    </div>
    <img id="frame" height="100%"
         src="https://s3-us-west-1.amazonaws.com/simplecast/nautilus.jpg"
         onload="imgLoaded()">
    <img id="prev" height="100%"
         src="https://s3-us-west-1.amazonaws.com/simplecast/previous.jpg">
    <script type="text/javascript">
      anim();
    </script>
  </body>
</html>
